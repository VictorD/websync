{% extends "base.html" %}
{% block content %}

<div id="filedisplay">
   {% for file in files %}
      <div class="file" id=file-{{file.id}}>
	      <div class="icon">
		      <img src="{{ file.extension }}">
	      </div>
	      <div class="name">
		      {{ file.filename }}
	      </div>
	      <div class="size">
		      {{ file.size }}
	      </div>
	      <div class="details">
		      <h3><a href="{{download_url}}{{file.id}}">download</a> | <a href="#" id="delete-{{file.id}}">delete</a> | status</h3>
		      <p>uploaded: {{ file.created_at }}</p>
		      <p>last sync: {{ file.last_sync }}</p>
	      </div>
      </div>
   {% endfor %}

<h3>Upload new File</h3>
<form action="" method=post enctype=multipart/form-data>
<p><input type=file name=file>
   <input type=submit value=Upload>
</form>

</div>

<script type="text/javascript">
	$("a[id^='delete-']").click(function(event) {
		var deleteId = event.target.id.slice(7);		
		$.ajax({
            url: '{{download_url}}' + deleteId + '/',
            type: 'DELETE',
            success: function(result) {
                 // Do something with the result
                $("#file-" + deleteId).hide();
        }
        });
	});
</script>	

{% endblock %}
